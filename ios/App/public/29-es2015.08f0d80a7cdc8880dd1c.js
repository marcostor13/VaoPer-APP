(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{TxCI:function(e,t,n){"use strict";n.r(t),n.d(t,"EditOffersPageModule",(function(){return O}));var i=n("ofXK"),r=n("3Pt+"),o=n("TEn/"),a=n("tyNb"),c=n("nYR2"),p=n("fXoL"),s=n("H+bZ"),l=n("b6Qw"),d=n("FQVY"),b=n("Vaw3"),g=n("rIor");function h(e,t){1&e&&(p.Wb(0,"div",25),p.Sb(1,"img",26),p.Vb())}function m(e,t){if(1&e){const e=p.Xb();p.Wb(0,"div",27),p.Wb(1,"div",28),p.Wb(2,"div",29),p.Wb(3,"h6",30),p.Jc(4,"Cortar Imagen"),p.Vb(),p.Wb(5,"img",31),p.ec("click",(function(){return p.zc(e),p.ic().handleCancelCortar()})),p.Vb(),p.Vb(),p.Wb(6,"div",4),p.Wb(7,"div",32),p.Wb(8,"div",33),p.Wb(9,"h5"),p.Jc(10,"Cortar Imagen"),p.Vb(),p.Wb(11,"image-cropper",34),p.ec("imageCropped",(function(t){return p.zc(e),p.ic().imageCropped(t)}))("imageLoaded",(function(){return p.zc(e),p.ic().imageLoaded()}))("cropperReady",(function(){return p.zc(e),p.ic().cropperReady()}))("loadImageFailed",(function(){return p.zc(e),p.ic().loadImageFailed()})),p.Vb(),p.Vb(),p.Wb(12,"div",35),p.Wb(13,"h5"),p.Jc(14,"Previsualizar"),p.Vb(),p.Sb(15,"img",36),p.Vb(),p.Vb(),p.Vb(),p.Wb(16,"div",37),p.Wb(17,"button",38),p.ec("click",(function(){return p.zc(e),p.ic().handleOkCortar()})),p.Jc(18,"Terminar"),p.Vb(),p.Vb(),p.Vb(),p.Vb()}if(2&e){const e=p.ic();p.Db(11),p.oc("imageChangedEvent",e.imageChangedEvent)("maintainAspectRatio",!0)("imageQuality",100)("aspectRatio",1)("resizeToWidth",0),p.Db(4),p.oc("src",e.croppedImage,p.Bc)}}const u=function(){return["/tabs-provider/portfolio/offers-provider"]},f=function(e){return{"background-image":e}},C=function(e){return{"text-danger":e}},M=[{path:"",component:(()=>{class e{constructor(e,t,n,i,r,o){this.route=e,this.router=t,this.api=n,this.cookie=i,this.general=r,this.storage=o,this.isVisible=!1,this.contentModal=null,this.fileToUpload=null,this.nameInputFile="",this.name="",this.description="",this.price="",this.response="",this.offer={},this.image="",this.startDate="",this.endDate="",this.enable=!0,this.isLoad=!1,this.isVisibleModal=!1,this.isVisibleCortar=!1,this.title="cloudsSorage",this.selectedFile=null,this.previewImage="",this.previewVisible=!1,this.invalid=!1,this.imageChangedEvent="",this.croppedImage="",this.handleUpload=e=>{this.isLoad=!0;var t=Date.now();const n=this.storage.ref("offers/"+t);this.storage.upload("offers/"+t,e).snapshotChanges().pipe(Object(c.a)(()=>{this.downloadURL=n.getDownloadURL(),this.downloadURL.subscribe(e=>{e&&(this.croppedImage=e,this.isLoad=!1),console.log("fb",e)})})).subscribe(e=>{})},this.id=this.route.snapshot.paramMap.get("id")}ngOnInit(){this.validateSession(),0!=this.id&&this.getOfferByID()}validateSession(){localStorage.getItem("ud")?this.user=JSON.parse(localStorage.getItem("ud")):window.location.href="/login"}back(){window.history.back()}getOfferByID(){let e={service:"get-offer-by-id",userid:this.user.user.id,offerid:this.id,token:this.user.token};this.api.c("getOfferByID pre",e),this.api.api(e).subscribe(e=>{this.api.c("getOfferByID",e),e.status?(this.name=e.data.name,this.description=e.data.description.replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n"),this.price=e.data.price,this.croppedImage=e.data.image,this.enable=1==e.data.enable):this.api.c("getOfferByID false",e)},e=>{this.api.c("getOfferByID error",e)})}saveOffer(){if(""==this.name||""==this.croppedImage||""==this.name||""==this.description||""==this.price)this.invalid=!0,this.response="Debe completar todos los campos";else{this.isLoad=!0;const e=new FormData;e.append("image",this.croppedImage),e.append("name",this.name),e.append("description",this.description),e.append("price",this.price),e.append("enable",this.enable?"1":"0"),e.append("token",this.user.token),e.append("userid",this.user.user.id),e.append("offerid",this.id),e.append("type","offer");const t=new Headers;t.append("Content-Type","multipart/form-data"),t.append("Accept","application/json"),t.append("Access-Control-Allow-Origin","*");let n={service:"save-offer",data:e,extra:{headers:t}};this.api.c("saveOffer pre",n),this.api.apiUpload(n).subscribe(e=>{this.api.c("saveOffer res",e),this.isLoad=!1,e.status?(this.response=e.message,0==this.id&&(this.name="",this.description="",this.image="",this.startDate="",this.endDate="")):this.api.c("saveOffer",e)},e=>{this.api.c("saveOffer error",e)})}}editDescriptionProduct(){}editPriceProduct(){}handleFileInput(e){this.fileToUpload=null,this.fileToUpload=e.item(0),this.nameInputFile=e.item(0).name,this.api.c("handleFileInput",this.nameInputFile)}showModal(e){this.contentModal=e,this.isVisible=!0}fileChangeEvent(e){this.showModalCortar(),this.imageChangedEvent=e}imageCropped(e){this.croppedImage=e.base64}imageLoaded(){}cropperReady(){}loadImageFailed(){}showModalCortar(){this.isVisibleCortar=!0}dataURItoBlob(e){const t=window.atob(e.replace(/^data:image\/(png|jpeg|jpg);base64,/,"")),n=new ArrayBuffer(t.length),i=new Uint8Array(n);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return new Blob([i],{type:"image/png"})}handleOkCortar(){this.isVisibleCortar=!1;const e=this.dataURItoBlob(this.croppedImage),t=new File([e],"name.png",{type:"image/png"});this.handleUpload(t)}handleCancelCortar(){this.isVisibleCortar=!1}}return e.\u0275fac=function(t){return new(t||e)(p.Rb(a.a),p.Rb(a.j),p.Rb(s.a),p.Rb(l.a),p.Rb(d.a),p.Rb(b.a))},e.\u0275cmp=p.Lb({type:e,selectors:[["app-edit-offers"]],decls:42,vars:16,consts:[[1,"pt-3","pr-3","pl-3"],[1,"btn1","pt-2","pb-2",3,"routerLink"],[1,"linea"],[1,"p-3","col-12","col-xl-5","pb-5","mb-5"],[1,"form-group","mt-2"],[1,"text-danger","f-9"],[1,"inputImage","cursor"],["accept","image/*","type","file",1,"form-control",3,"ngModel","change","ngModelChange"],[1,"cursor"],[1,"row","justify-content-center","mtprev"],[1,"row","flex-column","m-0","align-items-center","justify-content-center"],[1,"img-item","m-2",3,"ngStyle"],["type","text","placeholder","Ingrese el nombre",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","Ingrese la descripci\xf3n",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","Ingrese el precio",1,"form-control",3,"ngModel","ngModelChange"],[1,"sections","row","m-0","align-items-center"],[1,"switch"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"slider","round"],[1,"ml-4","font-700","p-0","mb-2"],[1,"row","justify-content-end","m-0","col-12"],[1,"btn1","font-700","pt-2","pb-2",3,"click"],[1,"text-color4","font-700","text-center",3,"ngClass"],["class","load",4,"ngIf"],["class","modal ",4,"ngIf"],[1,"load"],["src","/assets/img/partials/load.svg"],[1,"modal"],[1,"content-modal","modal2","p-5"],[1,"header-modal","row","m-0","justify-content-between","align-items-center"],[1,"title-modal","font-700","text-color2"],["width","20","src","assets/img/partials/close.svg",3,"click"],[1,"row",2,"margin-top","5%"],[1,"text-center","col-md-8"],["format","png",3,"imageChangedEvent","maintainAspectRatio","imageQuality","aspectRatio","resizeToWidth","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"text-center","col-md-4"],[1,"source-image",3,"src"],[1,"mt-3","row","justify-content-end"],[1,"btn1","pl-3","pr-3","pt-1","pb-1","mr-3",3,"click"]],template:function(e,t){1&e&&(p.Wb(0,"ion-content"),p.Wb(1,"header",0),p.Wb(2,"button",1),p.Jc(3,"Regresar"),p.Vb(),p.Vb(),p.Sb(4,"hr",2),p.Wb(5,"div",3),p.Wb(6,"div",4),p.Wb(7,"label",5),p.Jc(8,"* Requerido"),p.Vb(),p.Wb(9,"div",6),p.Wb(10,"input",7),p.ec("change",(function(e){return t.fileChangeEvent(e)}))("ngModelChange",(function(e){return t.image=e})),p.Vb(),p.Wb(11,"div",8),p.Jc(12,"Seleccione una imagen"),p.Vb(),p.Vb(),p.Vb(),p.Wb(13,"div",9),p.Wb(14,"div",10),p.Sb(15,"div",11),p.Vb(),p.Vb(),p.Wb(16,"div",4),p.Wb(17,"label",5),p.Jc(18,"* Requerido"),p.Vb(),p.Wb(19,"input",12),p.ec("ngModelChange",(function(e){return t.name=e})),p.Vb(),p.Vb(),p.Wb(20,"div",4),p.Wb(21,"label",5),p.Jc(22,"* Requerido"),p.Vb(),p.Wb(23,"input",13),p.ec("ngModelChange",(function(e){return t.description=e})),p.Vb(),p.Vb(),p.Wb(24,"div",4),p.Wb(25,"label",5),p.Jc(26,"* Requerido"),p.Vb(),p.Wb(27,"input",14),p.ec("ngModelChange",(function(e){return t.price=e})),p.Vb(),p.Vb(),p.Wb(28,"div",15),p.Wb(29,"label",16),p.Wb(30,"input",17),p.ec("ngModelChange",(function(e){return t.enable=e})),p.Vb(),p.Sb(31,"span",18),p.Vb(),p.Wb(32,"p",19),p.Jc(33,"Inactiva / Activa"),p.Vb(),p.Vb(),p.Wb(34,"div",20),p.Wb(35,"button",21),p.ec("click",(function(){return t.saveOffer()})),p.Jc(36,"Guardar"),p.Vb(),p.Vb(),p.Wb(37,"div",4),p.Wb(38,"p",22),p.Jc(39),p.Vb(),p.Vb(),p.Vb(),p.Hc(40,h,2,0,"div",23),p.Hc(41,m,19,6,"div",24),p.Vb()),2&e&&(p.Db(2),p.oc("routerLink",p.rc(11,u)),p.Db(8),p.oc("ngModel",t.image),p.Db(5),p.oc("ngStyle",p.sc(12,f,"url("+t.croppedImage+")")),p.Db(4),p.oc("ngModel",t.name),p.Db(4),p.oc("ngModel",t.description),p.Db(4),p.oc("ngModel",t.price),p.Db(3),p.oc("ngModel",t.enable),p.Db(8),p.oc("ngClass",p.sc(14,C,t.invalid)),p.Db(1),p.Kc(t.response),p.Db(1),p.oc("ngIf",t.isLoad),p.Db(1),p.oc("ngIf",t.isVisibleCortar))},directives:[o.d,o.s,a.k,r.b,r.f,r.g,i.m,r.a,i.j,i.l,g.a],styles:['.carrusel[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{background-size:cover;background-repeat:no-repeat;background-position:50%;min-width:100%;min-height:200px;border-radius:16px;padding:10px}.menu[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{min-width:20px;min-height:2px;background-color:#fff}.search[_ngcontent-%COMP%]{flex:1;position:relative}.search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-moz-placeholder{color:grey;font-size:12pt}.search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-ms-input-placeholder{color:grey;font-size:12pt}.search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{color:grey;font-size:12pt}.search[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:27%;left:20px;max-width:26px}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:12pt;width:100%;border:2.5px solid #ffe266;background-color:transparent;color:#333;border-radius:50px;padding:5px 5px 5px 58px;min-height:60px}.search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:focus{outline:0}.main-photo[_ngcontent-%COMP%]{border-radius:10px;background-color:#e6e6e6;min-height:260px}.add[_ngcontent-%COMP%]{max-width:40px}.modal[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.4);display:flex;justify-content:center;align-items:flex-start;position:fixed;min-width:100vw;min-height:100vh;top:0;left:0;z-index:100}.modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{border:0;background-color:#fff;margin-top:80px;border-radius:10px;padding:20px;min-height:100px}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:50px;height:28px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc}.slider[_ngcontent-%COMP%], .slider[_ngcontent-%COMP%]:before{position:absolute;transition:.4s}.slider[_ngcontent-%COMP%]:before{content:"";height:20px;width:20px;left:4px;bottom:4px;background-color:#fff}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#13bf9e}input[_ngcontent-%COMP%]:focus + .slider[_ngcontent-%COMP%]{box-shadow:0 0 1px #13bf9e}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translateX(22px)}.slider.round[_ngcontent-%COMP%]{border-radius:34px}.slider.round[_ngcontent-%COMP%]:before{border-radius:50%}.image-cropper[_ngcontent-%COMP%]{max-height:500px!important}.modal[_ngcontent-%COMP%]{overflow:auto}.modal2[_ngcontent-%COMP%]{max-width:80%!important;position:absolute;top:150px;margin-bottom:150px;background-color:#fff}.source-image[_ngcontent-%COMP%]{max-width:300px!important}.load[_ngcontent-%COMP%]{position:fixed;top:0;left:0;min-width:100vw;min-height:100vh;background-color:hsla(0,0%,100%,.9);display:flex;justify-content:center;align-items:center}.load[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{opacity:.9}@media (max-width:1300px){.modal2[_ngcontent-%COMP%]{max-width:90%!important}}@media (max-width:960px){.modal2[_ngcontent-%COMP%]{max-width:98%!important}}.img-item[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:cover;background-color:#e6e6e6;background-position:50%;min-width:80px;max-width:80px;max-height:80px;min-height:80px}.inputImage[_ngcontent-%COMP%]{position:relative;cursor:pointer}.inputImage[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;z-index:2}.inputImage[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .inputImage[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;top:0;left:0;border-radius:8px}.inputImage[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;opacity:1;min-width:100%;min-height:46px;background-color:#ffe266;z-index:1}.mtprev[_ngcontent-%COMP%]{margin-top:80px}']}),e})()}];let x=(()=>{class e{}return e.\u0275mod=p.Pb({type:e}),e.\u0275inj=p.Ob({factory:function(t){return new(t||e)},imports:[[a.l.forChild(M)],a.l]}),e})(),O=(()=>{class e{}return e.\u0275mod=p.Pb({type:e}),e.\u0275inj=p.Ob({factory:function(t){return new(t||e)},imports:[[i.c,r.c,o.o,x,g.b]]}),e})()}}]);