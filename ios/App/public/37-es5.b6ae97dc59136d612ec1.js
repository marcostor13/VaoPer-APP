function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{"4wSf":function(e,t,n){"use strict";n.r(t),n.d(t,"FeaturedPageModule",(function(){return D}));var i=n("ofXK"),a=n("3Pt+"),r=n("TEn/"),o=n("tyNb"),s=n("mrSG"),c=n("XNiG"),u=(n("gcOT"),n("fXoL")),l=n("H+bZ"),d=n("b6Qw"),p=n("FQVY"),g=n("/XPu");function f(e,t){if(1&e&&(u.Wb(0,"div",6),u.Wb(1,"h5",7),u.Jc(2),u.Vb(),u.Vb()),2&e){var n=u.ic();u.Db(2),u.Kc(n.response)}}var h=function(e){return{"background-image":e}};function b(e,t){if(1&e&&u.Sb(0,"div",26),2&e){var n=u.ic().$implicit;u.oc("ngStyle",u.sc(1,h,"url("+n.image+")"))}}function m(e,t){1&e&&u.Sb(0,"div",27)}function v(e,t){1&e&&(u.Ub(0),u.Jc(1,"..."),u.Tb())}function C(e,t){if(1&e&&(u.Wb(0,"p",28),u.Jc(1),u.Hc(2,v,2,0,"ng-container",29),u.Vb()),2&e){var n=u.ic().$implicit;u.Db(1),u.Kc(n.address1.substring(0,80)||""),u.Db(1),u.oc("ngIf",n.address1.length>79)}}var k=function(e){return[e]};function y(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div",10),u.Wb(1,"div",11),u.Hc(2,b,1,3,"div",12),u.Hc(3,m,1,0,"div",13),u.Vb(),u.Wb(4,"div",14),u.Wb(5,"div",15),u.Wb(6,"span",16),u.Jc(7),u.Vb(),u.Wb(8,"span",17),u.Jc(9),u.Vb(),u.Vb(),u.Wb(10,"div",18),u.Hc(11,C,3,2,"p",19),u.Vb(),u.Wb(12,"div",20),u.Wb(13,"div",21),u.Wb(14,"a",22),u.Jc(15,"LLAMADA"),u.Vb(),u.Wb(16,"button",23),u.ec("click",(function(){u.zc(n);var e=t.$implicit;return u.ic(2).message(e.userid,e.id,e.phone1)})),u.Jc(17,"WHATSAPP"),u.Vb(),u.Vb(),u.Wb(18,"div"),u.Wb(19,"img",24),u.ec("click",(function(){u.zc(n);var e=t.$implicit;return u.ic(2).share(e.url,e.comercialname)})),u.Vb(),u.Wb(20,"img",25),u.ec("click",(function(){u.zc(n);var e=t.$implicit;return u.ic(2).deleteFeaturedCompanies(e.featuredid)})),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb()}if(2&e){var i=t.$implicit;u.Db(1),u.oc("routerLink",u.sc(9,k,"/tabs/home/profile/"+i.id)),u.Db(1),u.oc("ngIf",i.image),u.Db(1),u.oc("ngIf",!i.image),u.Db(2),u.oc("routerLink",u.sc(11,k,"/profile/"+i.id)),u.Db(2),u.Kc(i.comercialname),u.Db(2),u.Lc("",1e6==i.distance?"-":i.distance," Km"),u.Db(1),u.oc("routerLink",u.sc(13,k,"/tabs/home/profile/"+i.id)),u.Db(1),u.oc("ngIf",i.address1&&""!=i.address1&&""!=i.address1),u.Db(3),u.qc("href","tel:",i.phone1,"",u.Bc)}}function w(e,t){if(1&e&&(u.Wb(0,"div",8),u.Hc(1,y,21,15,"div",9),u.Vb()),2&e){var n=u.ic();u.Db(1),u.oc("ngForOf",n.companiesData)}}function _(e,t){1&e&&(u.Wb(0,"div",30),u.Sb(1,"img",31),u.Vb())}var M,O,P,x=[{path:"",component:(M=function(){function e(t,n,i,a,r,o){_classCallCheck(this,e),this.route=t,this.router=n,this.api=i,this.cookie=a,this.general=r,this.socialSharing=o,this.eventsSubject=new c.a,this.urlBackEnd=this.general.getUrlImages("profile"),this.companiesData=[],this.isLoad=!0,this.service=new google.maps.DistanceMatrixService,this.search="",this.response=!1,this.currentPosition={}}return _createClass(e,[{key:"back",value:function(){window.history.back()}},{key:"searchEvent",value:function(){this.router.navigate(["/results/"+this.search]).then((function(){window.location.reload()}))}},{key:"ngOnInit",value:function(){this.validateSession(),this.getCategoriesAndSubcategories()}},{key:"ionViewWillEnter",value:function(){this.getCompaniesDataFeatured()}},{key:"getCategoriesAndSubcategories",value:function(){var e=this;this.api.api({service:"get-categories-and-subcategories"}).subscribe((function(t){e.api.c("getCategoriesAndSubcategories result",t),e.categories=t,e.isLoad=!1}),(function(t){e.api.c("Error getCategoriesAndSubcategories",t)}))}},{key:"validateSession",value:function(){localStorage.getItem("ud")?this.user=JSON.parse(localStorage.getItem("ud")):window.location.href="/login"}},{key:"getCompaniesDataFeatured",value:function(){var e=this;this.user&&(this.isLoad=!0,this.companiesData=[],this.api.api({userid:this.user.user.id,token:this.user.token,service:"get-companies-data-featured"}).subscribe((function(t){return Object(s.__awaiter)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.api.c("getCompaniesDataFeatured",t),!t.status){e.next=13;break}if(!(t.data.length>0)){e.next=10;break}return this.response="",this.isLoad=!1,e.next=7,this.getCurrentPosition(t.data);case 7:this.companiesData=e.sent,e.next=11;break;case 10:this.response="No tiene negocios favoritos",this.isLoad=!1;case 11:e.next=14;break;case 13:this.api.c("getCompaniesDataFeatured false",t);case 14:case"end":return e.stop()}}),e,this)})))}),(function(t){401==t.status&&(alert("Su sesi\xf3n ha vencido"),e.router.navigate(["/login"])),e.api.c("Error getCompaniesDataFeatured",t)})))}},{key:"getUriImage",value:function(e){return encodeURI(e)}},{key:"rad",value:function(e){return e*Math.PI/180}},{key:"getKilometros",value:function(e,t,n,i){var a=this.rad(n-e),r=this.rad(i-t),o=Math.sin(a/2)*Math.sin(a/2)+Math.cos(this.rad(e))*Math.cos(this.rad(n))*Math.sin(r/2)*Math.sin(r/2);return(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))*6378.137).toFixed(1)}},{key:"getCurrentPosition",value:function(e){return Object(s.__awaiter)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,a,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],t.next=3,this.general.getPosition();case 3:if(i=t.sent){a=_createForOfIteratorHelper(e);try{for(a.s();!(r=a.n()).done;)o=r.value,this.api.c("Element",o),o.distance=o.lat?parseFloat(this.getKilometros(o.lat,o.lng,i.lat,i.lng)):1e6,n.push(o)}catch(s){a.e(s)}finally{a.f()}}return t.abrupt("return",n=n.sort((function(e,t){return e.distance>t.distance?1:e.distance<t.distance?-1:0})));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"updateCoordinates",value:function(e,t,n){var i=this;this.api.api({token:this.user.token,companyid:n,service:"update-coordinates",lat:e,lng:t}).subscribe((function(e){i.isLoad=!1,i.api.c("addFeaturedCompanies",e)}),(function(e){i.api.c("Error addFeaturedCompanies",e)}))}},{key:"addFeaturedCompanies",value:function(e,t){var n=this;this.api.api({userid:this.user.user.id,token:this.user.token,companyid:e,service:"add-featured-companies"}).subscribe((function(e){n.api.c("addFeaturedCompanies",e),e.status?(n.api.c("addFeaturedCompanies true",t.target.disabled),t.target.src="/assets/img/partials/star-g.svg"):n.api.c("addFeaturedCompanies false",e)}),(function(e){n.api.c("Error addFeaturedCompanies",e)}))}},{key:"deleteFeaturedCompanies",value:function(e){var t=this;this.isLoad=!0,this.api.api({token:this.user.token,featuredid:e,service:"delete-featured-companies"}).subscribe((function(e){t.api.c("deleteFeaturedCompanies",e),t.isLoad=!1,e.status?t.getCompaniesDataFeatured():t.api.c("deleteFeaturedCompanies false",e)}),(function(e){t.api.c("Error deleteFeaturedCompanies",e)}))}},{key:"share",value:function(e,t){var n=this;this.socialSharing.share(t,document.title,null,"https://vaoperu.com/web/"+e).then((function(t){n.general.saveEvent("share",e)}))}},{key:"toogleMenu",value:function(){this.api.c("toogleMenuFather","ok"),this.eventsSubject.next()}},{key:"message",value:function(e,t,n){n&&(window.location.href="https://api.whatsapp.com/send?phone=51".concat(n,"&text=Hola, soy usuario VAO")),this.general.saveEvent("message",t)}},{key:"createChat",value:function(e,t){return this.api.createChat({collection:"chats",token:this.user.token,useridOri:e,useridDes:t}),!0}}]),e}(),M.\u0275fac=function(e){return new(e||M)(u.Rb(o.a),u.Rb(o.j),u.Rb(l.a),u.Rb(d.a),u.Rb(p.a),u.Rb(g.a))},M.\u0275cmp=u.Lb({type:M,selectors:[["app-featured"]],decls:7,vars:3,consts:[[1,"content","bg-white"],["class","col-12 m-0 mt-5",4,"ngIf"],["class","p-3 row m-0",4,"ngIf"],["id","map"],["map",""],["class","load",4,"ngIf"],[1,"col-12","m-0","mt-5"],[1,"text-center","text-color2"],[1,"p-3","row","m-0"],["class","item row m-0 col-12 p-0 mt-3",4,"ngFor","ngForOf"],[1,"item","row","m-0","col-12","p-0","mt-3"],[1,"col-12","m-0","p-0",3,"routerLink"],["class","img-item",3,"ngStyle",4,"ngIf"],["class","img-item",4,"ngIf"],[1,"p-3","col-12"],[1,"row","m-0","justify-content-between",3,"routerLink"],[1,"f-11","font-700","col-12","p-0"],[1,"f-11","font-700","text-color6"],[1,"row","m-0","justify-content-between","mt-2",3,"routerLink"],["class","f-10",4,"ngIf"],[1,"row","m-0","justify-content-between","align-items-start"],[1,"row","m-0"],[1,"btn1","flex-1","pt-2","pb-2","mr-2","font-700","text-center","link-unstyled",3,"href"],[1,"btn2","flex-1","pt-2","pb-2","font-700",3,"click"],["width","22","src","/assets/img/partials/share.svg","alt","",1,"ml-2",3,"click"],["width","20","src","/assets/img/partials/delete.svg","alt","",1,"ml-2",3,"click"],[1,"img-item",3,"ngStyle"],[1,"img-item"],[1,"f-10"],[4,"ngIf"],[1,"load"],["src","/assets/img/partials/load.svg"]],template:function(e,t){1&e&&(u.Wb(0,"ion-content"),u.Wb(1,"div",0),u.Hc(2,f,3,1,"div",1),u.Hc(3,w,2,1,"div",2),u.Sb(4,"div",3,4),u.Vb(),u.Hc(6,_,2,0,"div",5),u.Vb()),2&e&&(u.Db(2),u.oc("ngIf",t.response),u.Db(1),u.oc("ngIf",!t.isLoad),u.Db(3),u.oc("ngIf",t.isLoad))},directives:[r.d,i.l,i.k,r.s,o.k,i.m],styles:[".linea[_ngcontent-%COMP%]{border-bottom:3px solid #e6e6e6}.content[_ngcontent-%COMP%]{min-height:100vh}.content[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{min-width:20px;min-height:2px;background-color:#fff}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{flex:1;position:relative}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-moz-placeholder{color:grey;font-size:12pt}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-ms-input-placeholder{color:grey;font-size:12pt}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{color:grey;font-size:12pt}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:27%;left:20px;max-width:26px}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:12pt;width:100%;border:2.5px solid #ffe266;background-color:transparent;color:#333;border-radius:50px;padding:5px 5px 5px 58px;min-height:60px}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:focus{outline:0}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:50px!important;position:absolute;right:0;top:3px}.item[_ngcontent-%COMP%]{box-shadow:1px 3px 8px 5px #c2c2c2;border-radius:10px}.item[_ngcontent-%COMP%]   .img-item[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:cover;background-position:50%;background-color:#c2c2c2;border-radius:10px 10px 0 0;max-width:100%;min-width:100%;max-height:90.8vw;min-height:90.8vw}.load[_ngcontent-%COMP%]{position:fixed;top:0;left:0;min-width:100vw;min-height:100vh;background-color:hsla(0,0%,100%,.9);display:flex;justify-content:center;align-items:center}.load[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{opacity:.9}[_ngcontent-%COMP%]:focus{outline:0}button[_ngcontent-%COMP%]:disabled{background-color:#e6e6e6!important}"]}),M)}],S=((P=function e(){_classCallCheck(this,e)}).\u0275mod=u.Pb({type:P}),P.\u0275inj=u.Ob({factory:function(e){return new(e||P)},imports:[[o.l.forChild(x)],o.l]}),P),D=((O=function e(){_classCallCheck(this,e)}).\u0275mod=u.Pb({type:O}),O.\u0275inj=u.Ob({factory:function(e){return new(e||O)},providers:[g.a],imports:[[i.c,a.c,r.o,S]]}),O)}}]);