(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{xp4b:function(e,t,n){"use strict";n.r(t),n.d(t,"EditProductsPageModule",(function(){return v}));var i=n("ofXK"),r=n("3Pt+"),o=n("TEn/"),a=n("tyNb"),c=n("nYR2"),s=n("fXoL"),p=n("H+bZ"),l=n("b6Qw"),d=n("FQVY"),b=n("Vaw3"),g=n("rIor");const h=function(e){return{"background-image":e}};function m(e,t){if(1&e){const e=s.Xb();s.Wb(0,"div",18),s.Sb(1,"div",19),s.Wb(2,"label",20),s.ec("click",(function(){s.zc(e);const n=t.index,i=t.$implicit;return s.ic().deleteProductImage(n,i.image)})),s.Jc(3,"X"),s.Vb(),s.Sb(4,"div"),s.Vb()}if(2&e){const e=t.$implicit;s.Db(1),s.oc("ngStyle",s.sc(1,h,"url("+e.image+")"))}}function u(e,t){1&e&&(s.Wb(0,"div",21),s.Sb(1,"img",22),s.Vb())}function f(e,t){if(1&e){const e=s.Xb();s.Wb(0,"div",23),s.Wb(1,"div",24),s.Wb(2,"div",25),s.Wb(3,"h6",26),s.Jc(4,"Cortar Imagen"),s.Vb(),s.Wb(5,"img",27),s.ec("click",(function(){return s.zc(e),s.ic().handleCancelCortar()})),s.Vb(),s.Vb(),s.Wb(6,"div",4),s.Wb(7,"div",28),s.Wb(8,"div",29),s.Wb(9,"h5"),s.Jc(10,"Cortar Imagen"),s.Vb(),s.Wb(11,"image-cropper",30),s.ec("imageCropped",(function(t){return s.zc(e),s.ic().imageCropped(t)}))("imageLoaded",(function(){return s.zc(e),s.ic().imageLoaded()}))("cropperReady",(function(){return s.zc(e),s.ic().cropperReady()}))("loadImageFailed",(function(){return s.zc(e),s.ic().loadImageFailed()})),s.Vb(),s.Vb(),s.Wb(12,"div",31),s.Wb(13,"h5"),s.Jc(14,"Previsualizar"),s.Vb(),s.Sb(15,"img",32),s.Vb(),s.Vb(),s.Vb(),s.Wb(16,"div",33),s.Wb(17,"button",34),s.ec("click",(function(){return s.zc(e),s.ic().handleOkCortar()})),s.Jc(18,"Terminar"),s.Vb(),s.Vb(),s.Vb(),s.Vb()}if(2&e){const e=s.ic();s.Db(11),s.oc("imageChangedEvent",e.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",1)("resizeToWidth",0)("imageQuality",100),s.Db(4),s.oc("src",e.croppedImage,s.Bc)}}const C=function(){return["/tabs-provider/portfolio/products-provider"]},x=[{path:"",component:(()=>{class e{constructor(e,t,n,i,r,o,a){this.route=e,this.router=t,this.api=n,this.cookie=i,this.general=r,this.storage=o,this.modalController=a,this.isVisible=!1,this.contentModal=null,this.fileToUpload=null,this.nameInputFile="",this.name="",this.description="",this.price="",this.response="",this.product={},this.image="",this.isLoad=!1,this.isVisibleModal=!1,this.isVisibleCortar=!1,this.title="cloudsSorage",this.selectedFile=null,this.previewImage="",this.previewVisible=!1,this.imageChangedEvent="",this.croppedImage="",this.imagesArray=[],this.handleUpload=e=>{this.isLoad=!0;var t=Date.now();const n=this.storage.ref("products/"+t);this.storage.upload("products/"+t,e).snapshotChanges().pipe(Object(c.a)(()=>{this.downloadURL=n.getDownloadURL(),this.downloadURL.subscribe(e=>{e&&(this.imagesArray.push({image:e}),this.imagesArray=this.imagesArray,this.isLoad=!1),console.log("fb",e)})})).subscribe(e=>{})},this.id=this.route.snapshot.paramMap.get("id")}ngOnInit(){this.validateSession(),0!=this.id&&this.getProductsByID()}validateSession(){localStorage.getItem("ud")?this.user=JSON.parse(localStorage.getItem("ud")):window.location.href="/login"}back(){window.history.back()}isJson(e){try{JSON.parse(e)}catch(t){return!1}return!0}getProductsByID(){this.isLoad=!0;let e={service:"get-products-by-id",userid:this.user.user.id,productid:this.id,token:this.user.token};this.api.c("getProductsByID pre",e),this.api.api(e).subscribe(e=>{this.api.c("getProductsByID",e),this.isLoad=!1,e.status?(this.name=e.data.name,this.description=e.data.description.replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n"),this.price=e.data.price,this.imagesArray=e.data.images):this.api.c("getProductsByID false",e)},e=>{this.api.c("getProductsByID error",e)})}saveProduct(){this.isLoad=!0;let e={service:"save-product",name:this.name,price:this.price,description:this.description.replace(/\n\r?/g,"<br />"),userid:this.user.user.id,type:"product",image:this.imagesArray.length>0?this.imagesArray:"",token:this.user.token,productid:this.id};this.api.api(e).subscribe(e=>{this.api.c("saveProduct res",e),this.isLoad=!1,e.status&&(this.response=e.message,0==this.id&&(this.name="",this.description="",this.price="",this.image="",this.imagesArray=[]))},e=>{this.api.c("saveProduct error",e)})}handleFileInput(e){this.fileToUpload=null,this.fileToUpload=e.item(0),this.nameInputFile=e.item(0).name,this.api.c("handleFileInput",this.nameInputFile)}fileChangeEvent(e){this.showModalCortar(),this.imageChangedEvent=e}imageCropped(e){this.croppedImage=e.base64}imageLoaded(){}cropperReady(){}loadImageFailed(){}dataURItoBlob(e){const t=window.atob(e.replace(/^data:image\/(png|jpeg|jpg);base64,/,"")),n=new ArrayBuffer(t.length),i=new Uint8Array(n);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return new Blob([i],{type:"image/png"})}showModalCortar(){this.isVisibleCortar=!0}handleOkCortar(){this.isLoad=!0,this.isVisibleCortar=!1;const e=this.dataURItoBlob(this.croppedImage),t=new File([e],"name.png",{type:"image/png"});this.handleUpload(t)}handleCancelCortar(){this.isVisibleCortar=!1}showModal(e){this.contentModal=e,this.isVisible=!0}deleteProductImage(e,t){this.isLoad=!0,this.storage.storage.refFromURL(t).delete().then(()=>{this.imagesArray.splice(e,1),this.saveProduct()})}}return e.\u0275fac=function(t){return new(t||e)(s.Rb(a.a),s.Rb(a.j),s.Rb(p.a),s.Rb(l.a),s.Rb(d.a),s.Rb(b.a),s.Rb(o.q))},e.\u0275cmp=s.Lb({type:e,selectors:[["app-edit-products"]],decls:31,vars:10,consts:[[1,"pt-3","pr-3","pl-3"],[1,"btn1","pt-2","pb-2",3,"routerLink"],[1,"linea"],[1,"p-3","col-xl-5","col-12"],[1,"form-group","mt-2"],[1,"inputImage"],["accept","image/*","type","file",1,"form-control",3,"ngModel","change","ngModelChange"],[1,"row","justify-content-center","mt-5"],["class","row flex-column m-0 align-items-center justify-content-center",4,"ngFor","ngForOf"],[1,"p-3","col-xl-5","col-12","pb-5","mb-5"],["type","text","placeholder","Ingrese el nombre",1,"form-control",3,"ngModel","ngModelChange"],["name","","id","","cols","30","rows","4","placeholder","Ingrese la descripci\xf3n",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","Ingrese el precio",1,"form-control",3,"ngModel","ngModelChange"],[1,"row","justify-content-end","m-0","col-12"],[1,"btn1","font-700","pt-2","pb-2",3,"click"],[1,"text-color4","font-700","text-center"],["class","load",4,"ngIf"],["class","modal",4,"ngIf"],[1,"row","flex-column","m-0","align-items-center","justify-content-center"],[1,"img-item","m-2",3,"ngStyle"],["title","Eliminar",1,"pi","pi-times","text-danger","font-900","cursor","f-16",3,"click"],[1,"load"],["src","/assets/img/partials/load.svg"],[1,"modal"],[1,"content-modal","modal2","p-5"],[1,"header-modal","row","m-0","justify-content-between","align-items-center"],[1,"title-modal","font-700","text-color2"],["width","20","src","assets/img/partials/close.svg",3,"click"],[1,"row",2,"margin-top","5%"],[1,"text-center","col-md-8"],["format","png",3,"imageChangedEvent","maintainAspectRatio","aspectRatio","resizeToWidth","imageQuality","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"text-center","col-md-4"],[1,"source-image",3,"src"],[1,"mt-3","row","justify-content-end"],[1,"btn1","pl-3","pr-3","pt-1","pb-1","mr-3",3,"click"]],template:function(e,t){1&e&&(s.Wb(0,"ion-content"),s.Wb(1,"header",0),s.Wb(2,"button",1),s.Jc(3,"Regresar"),s.Vb(),s.Vb(),s.Sb(4,"hr",2),s.Wb(5,"div",3),s.Wb(6,"h4"),s.Jc(7,"Im\xe1genes"),s.Vb(),s.Wb(8,"div",4),s.Wb(9,"div",5),s.Wb(10,"input",6),s.ec("change",(function(e){return t.fileChangeEvent(e)}))("ngModelChange",(function(e){return t.image=e})),s.Vb(),s.Wb(11,"div"),s.Jc(12,"Seleccione una imagen"),s.Vb(),s.Vb(),s.Vb(),s.Wb(13,"div",7),s.Hc(14,m,5,3,"div",8),s.Vb(),s.Sb(15,"hr"),s.Vb(),s.Wb(16,"div",9),s.Wb(17,"div",4),s.Wb(18,"input",10),s.ec("ngModelChange",(function(e){return t.name=e})),s.Vb(),s.Vb(),s.Wb(19,"div",4),s.Wb(20,"textarea",11),s.ec("ngModelChange",(function(e){return t.description=e})),s.Vb(),s.Vb(),s.Wb(21,"div",4),s.Wb(22,"input",12),s.ec("ngModelChange",(function(e){return t.price=e})),s.Vb(),s.Vb(),s.Wb(23,"div",13),s.Wb(24,"button",14),s.ec("click",(function(){return t.saveProduct()})),s.Jc(25,"Guardar"),s.Vb(),s.Vb(),s.Wb(26,"div",4),s.Wb(27,"p",15),s.Jc(28),s.Vb(),s.Vb(),s.Vb(),s.Hc(29,u,2,0,"div",16),s.Hc(30,f,19,6,"div",17),s.Vb()),2&e&&(s.Db(2),s.oc("routerLink",s.rc(9,C)),s.Db(8),s.oc("ngModel",t.image),s.Db(4),s.oc("ngForOf",t.imagesArray),s.Db(4),s.oc("ngModel",t.name),s.Db(2),s.oc("ngModel",t.description),s.Db(2),s.oc("ngModel",t.price),s.Db(6),s.Kc(t.response),s.Db(1),s.oc("ngIf",t.isLoad),s.Db(1),s.oc("ngIf",t.isVisibleCortar))},directives:[o.d,o.s,a.k,r.b,r.f,r.g,i.k,i.l,i.m,g.a],styles:[".carrusel[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{background-size:cover;background-repeat:no-repeat;background-position:50%;min-width:100%;min-height:200px;border-radius:16px;padding:10px}.menu[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{min-width:20px;min-height:2px;background-color:#fff}.search[_ngcontent-%COMP%]{flex:1;position:relative}.search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-moz-placeholder{color:grey;font-size:12pt}.search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-ms-input-placeholder{color:grey;font-size:12pt}.search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{color:grey;font-size:12pt}.search[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:27%;left:20px;max-width:26px}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:12pt;width:100%;border:2.5px solid #ffe266;background-color:transparent;color:#333;border-radius:50px;padding:5px 5px 5px 58px;min-height:60px}.search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:focus{outline:0}.main-photo[_ngcontent-%COMP%]{border-radius:10px;background-color:#e6e6e6;min-height:260px}.add[_ngcontent-%COMP%]{max-width:40px}.modal[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.4);display:flex;justify-content:center;align-items:flex-start;position:fixed;min-width:100vw;min-height:100vh;top:0;left:0;z-index:100}.modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{border:0;background-color:#fff;margin-top:80px;border-radius:10px;padding:20px;min-height:100px}.load[_ngcontent-%COMP%]{position:fixed;top:0;left:0;min-width:100vw;min-height:100vh;background-color:hsla(0,0%,100%,.9);display:flex;justify-content:center;align-items:center}.load[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{opacity:.9}.image-cropper[_ngcontent-%COMP%]{max-height:500px!important}.source-image[_ngcontent-%COMP%]{max-width:300px!important}.modal[_ngcontent-%COMP%]{overflow:auto}.modal2[_ngcontent-%COMP%]{max-width:90%!important;min-width:90%!important;position:absolute;top:150px;margin-bottom:150px;background-color:#fff}@media (max-width:1300px){.modal2[_ngcontent-%COMP%]{max-width:90%!important}}@media (max-width:960px){.modal2[_ngcontent-%COMP%]{max-width:98%!important}}.img-item[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:cover;background-color:#e6e6e6;background-position:50%;min-width:80px;max-width:80px;max-height:80px;min-height:80px}.inputImage[_ngcontent-%COMP%]{position:relative;cursor:pointer}.inputImage[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;z-index:2}.inputImage[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .inputImage[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;top:0;left:0;border-radius:8px}.inputImage[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;opacity:1;min-width:100%;min-height:40px;background-color:#ffe266;z-index:1}"]}),e})()}];let M=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},imports:[[a.l.forChild(x)],a.l]}),e})(),v=(()=>{class e{}return e.\u0275mod=s.Pb({type:e}),e.\u0275inj=s.Ob({factory:function(t){return new(t||e)},imports:[[i.c,r.c,o.o,M,g.b]]}),e})()}}]);