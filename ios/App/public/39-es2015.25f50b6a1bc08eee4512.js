(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{"4wSf":function(t,e,i){"use strict";i.r(e),i.d(e,"FeaturedPageModule",(function(){return x}));var n=i("ofXK"),o=i("3Pt+"),s=i("TEn/"),a=i("tyNb"),c=i("mrSG"),r=i("XNiG"),d=(i("gcOT"),i("fXoL")),p=i("H+bZ"),g=i("b6Qw"),u=i("FQVY"),l=i("/XPu");function h(t,e){if(1&t&&(d.Wb(0,"div",6),d.Wb(1,"h5",7),d.Jc(2),d.Vb(),d.Vb()),2&t){const t=d.ic();d.Db(2),d.Kc(t.response)}}const b=function(t){return{"background-image":t}};function m(t,e){if(1&t&&d.Sb(0,"div",26),2&t){const t=d.ic().$implicit;d.oc("ngStyle",d.sc(1,b,"url("+t.image+")"))}}function f(t,e){1&t&&d.Sb(0,"div",27)}function C(t,e){1&t&&(d.Ub(0),d.Jc(1,"..."),d.Tb())}function v(t,e){if(1&t&&(d.Wb(0,"p",28),d.Jc(1),d.Hc(2,C,2,0,"ng-container",29),d.Vb()),2&t){const t=d.ic().$implicit;d.Db(1),d.Kc(t.address1.substring(0,80)||""),d.Db(1),d.oc("ngIf",t.address1.length>79)}}const M=function(t){return[t]};function w(t,e){if(1&t){const t=d.Xb();d.Wb(0,"div",10),d.Wb(1,"div",11),d.Hc(2,m,1,3,"div",12),d.Hc(3,f,1,0,"div",13),d.Vb(),d.Wb(4,"div",14),d.Wb(5,"div",15),d.Wb(6,"span",16),d.Jc(7),d.Vb(),d.Wb(8,"span",17),d.Jc(9),d.Vb(),d.Vb(),d.Wb(10,"div",18),d.Hc(11,v,3,2,"p",19),d.Vb(),d.Wb(12,"div",20),d.Wb(13,"div",21),d.Wb(14,"a",22),d.Jc(15,"LLAMADA"),d.Vb(),d.Wb(16,"button",23),d.ec("click",(function(){d.zc(t);const i=e.$implicit;return d.ic(2).message(i.userid,i.id,i.phone1)})),d.Jc(17,"WHATSAPP"),d.Vb(),d.Vb(),d.Wb(18,"div"),d.Wb(19,"img",24),d.ec("click",(function(){d.zc(t);const i=e.$implicit;return d.ic(2).share(i.url,i.comercialname)})),d.Vb(),d.Wb(20,"img",25),d.ec("click",(function(){d.zc(t);const i=e.$implicit;return d.ic(2).deleteFeaturedCompanies(i.featuredid)})),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb()}if(2&t){const t=e.$implicit;d.Db(1),d.oc("routerLink",d.sc(9,M,"/tabs/home/profile/"+t.id)),d.Db(1),d.oc("ngIf",t.image),d.Db(1),d.oc("ngIf",!t.image),d.Db(2),d.oc("routerLink",d.sc(11,M,"/profile/"+t.id)),d.Db(2),d.Kc(t.comercialname),d.Db(2),d.Lc("",1e6==t.distance?"-":t.distance," Km"),d.Db(1),d.oc("routerLink",d.sc(13,M,"/tabs/home/profile/"+t.id)),d.Db(1),d.oc("ngIf",t.address1&&""!=t.address1&&""!=t.address1),d.Db(3),d.qc("href","tel:",t.phone1,"",d.Bc)}}function P(t,e){if(1&t&&(d.Wb(0,"div",8),d.Hc(1,w,21,15,"div",9),d.Vb()),2&t){const t=d.ic();d.Db(1),d.oc("ngForOf",t.companiesData)}}function O(t,e){1&t&&(d.Wb(0,"div",30),d.Sb(1,"img",31),d.Vb())}const k=[{path:"",component:(()=>{class t{constructor(t,e,i,n,o,s){this.route=t,this.router=e,this.api=i,this.cookie=n,this.general=o,this.socialSharing=s,this.eventsSubject=new r.a,this.urlBackEnd=this.general.getUrlImages("profile"),this.companiesData=[],this.isLoad=!0,this.service=new google.maps.DistanceMatrixService,this.search="",this.response=!1,this.currentPosition={}}back(){window.history.back()}searchEvent(){this.router.navigate(["/results/"+this.search]).then(()=>{window.location.reload()})}ngOnInit(){this.validateSession(),this.getCategoriesAndSubcategories()}ionViewWillEnter(){this.getCompaniesDataFeatured()}getCategoriesAndSubcategories(){this.api.api({service:"get-categories-and-subcategories"}).subscribe(t=>{this.api.c("getCategoriesAndSubcategories result",t),this.categories=t,this.isLoad=!1},t=>{this.api.c("Error getCategoriesAndSubcategories",t)})}validateSession(){localStorage.getItem("ud")?this.user=JSON.parse(localStorage.getItem("ud")):window.location.href="/login"}getCompaniesDataFeatured(){this.user&&(this.isLoad=!0,this.companiesData=[],this.api.api({userid:this.user.user.id,token:this.user.token,service:"get-companies-data-featured"}).subscribe(t=>Object(c.__awaiter)(this,void 0,void 0,(function*(){this.api.c("getCompaniesDataFeatured",t),t.status?t.data.length>0?(this.response="",this.isLoad=!1,this.companiesData=yield this.getCurrentPosition(t.data)):(this.response="No tiene negocios favoritos",this.isLoad=!1):this.api.c("getCompaniesDataFeatured false",t)})),t=>{401==t.status&&(alert("Su sesi\xf3n ha vencido"),this.router.navigate(["/login"])),this.api.c("Error getCompaniesDataFeatured",t)}))}getUriImage(t){return encodeURI(t)}rad(t){return t*Math.PI/180}getKilometros(t,e,i,n){var o=this.rad(i-t),s=this.rad(n-e),a=Math.sin(o/2)*Math.sin(o/2)+Math.cos(this.rad(t))*Math.cos(this.rad(i))*Math.sin(s/2)*Math.sin(s/2);return(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6378.137).toFixed(1)}getCurrentPosition(t){return Object(c.__awaiter)(this,void 0,void 0,(function*(){let e=[];const i=yield this.general.getPosition();if(i)for(const n of t)this.api.c("Element",n),n.distance=n.lat?parseFloat(this.getKilometros(n.lat,n.lng,i.lat,i.lng)):1e6,e.push(n);return e=e.sort((function(t,e){return t.distance>e.distance?1:t.distance<e.distance?-1:0})),e}))}updateCoordinates(t,e,i){this.api.api({token:this.user.token,companyid:i,service:"update-coordinates",lat:t,lng:e}).subscribe(t=>{this.isLoad=!1,this.api.c("addFeaturedCompanies",t)},t=>{this.api.c("Error addFeaturedCompanies",t)})}addFeaturedCompanies(t,e){this.api.api({userid:this.user.user.id,token:this.user.token,companyid:t,service:"add-featured-companies"}).subscribe(t=>{this.api.c("addFeaturedCompanies",t),t.status?(this.api.c("addFeaturedCompanies true",e.target.disabled),e.target.src="/assets/img/partials/star-g.svg"):this.api.c("addFeaturedCompanies false",t)},t=>{this.api.c("Error addFeaturedCompanies",t)})}deleteFeaturedCompanies(t){this.isLoad=!0,this.api.api({token:this.user.token,featuredid:t,service:"delete-featured-companies"}).subscribe(t=>{this.api.c("deleteFeaturedCompanies",t),this.isLoad=!1,t.status?this.getCompaniesDataFeatured():this.api.c("deleteFeaturedCompanies false",t)},t=>{this.api.c("Error deleteFeaturedCompanies",t)})}share(t,e){this.socialSharing.share(e,document.title,null,"https://vaoperu.com/web/"+t).then(e=>{this.general.saveEvent("share",t)})}toogleMenu(){this.api.c("toogleMenuFather","ok"),this.eventsSubject.next()}message(t,e,i){i&&(window.location.href=`https://api.whatsapp.com/send?phone=51${i}&text=Hola, soy usuario VAO`),this.general.saveEvent("message",e)}createChat(t,e){return this.api.createChat({collection:"chats",token:this.user.token,useridOri:t,useridDes:e}),!0}}return t.\u0275fac=function(e){return new(e||t)(d.Rb(a.a),d.Rb(a.j),d.Rb(p.a),d.Rb(g.a),d.Rb(u.a),d.Rb(l.a))},t.\u0275cmp=d.Lb({type:t,selectors:[["app-featured"]],decls:7,vars:3,consts:[[1,"content","bg-white"],["class","col-12 m-0 mt-5",4,"ngIf"],["class","p-3 row m-0",4,"ngIf"],["id","map"],["map",""],["class","load",4,"ngIf"],[1,"col-12","m-0","mt-5"],[1,"text-center","text-color2"],[1,"p-3","row","m-0"],["class","item row m-0 col-12 p-0 mt-3",4,"ngFor","ngForOf"],[1,"item","row","m-0","col-12","p-0","mt-3"],[1,"col-12","m-0","p-0",3,"routerLink"],["class","img-item",3,"ngStyle",4,"ngIf"],["class","img-item",4,"ngIf"],[1,"p-3","col-12"],[1,"row","m-0","justify-content-between",3,"routerLink"],[1,"f-11","font-700","col-12","p-0"],[1,"f-11","font-700","text-color6"],[1,"row","m-0","justify-content-between","mt-2",3,"routerLink"],["class","f-10",4,"ngIf"],[1,"row","m-0","justify-content-between","align-items-start"],[1,"row","m-0"],[1,"btn1","flex-1","pt-2","pb-2","mr-2","font-700","text-center","link-unstyled",3,"href"],[1,"btn2","flex-1","pt-2","pb-2","font-700",3,"click"],["width","22","src","/assets/img/partials/share.svg","alt","",1,"ml-2",3,"click"],["width","20","src","/assets/img/partials/delete.svg","alt","",1,"ml-2",3,"click"],[1,"img-item",3,"ngStyle"],[1,"img-item"],[1,"f-10"],[4,"ngIf"],[1,"load"],["src","/assets/img/partials/load.svg"]],template:function(t,e){1&t&&(d.Wb(0,"ion-content"),d.Wb(1,"div",0),d.Hc(2,h,3,1,"div",1),d.Hc(3,P,2,1,"div",2),d.Sb(4,"div",3,4),d.Vb(),d.Hc(6,O,2,0,"div",5),d.Vb()),2&t&&(d.Db(2),d.oc("ngIf",e.response),d.Db(1),d.oc("ngIf",!e.isLoad),d.Db(3),d.oc("ngIf",e.isLoad))},directives:[s.d,n.l,n.k,s.s,a.k,n.m],styles:[".linea[_ngcontent-%COMP%]{border-bottom:3px solid #e6e6e6}.content[_ngcontent-%COMP%]{min-height:100vh}.content[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{min-width:20px;min-height:2px;background-color:#fff}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{flex:1;position:relative}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-moz-placeholder{color:grey;font-size:12pt}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-ms-input-placeholder{color:grey;font-size:12pt}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{color:grey;font-size:12pt}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:27%;left:20px;max-width:26px}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:12pt;width:100%;border:2.5px solid #ffe266;background-color:transparent;color:#333;border-radius:50px;padding:5px 5px 5px 58px;min-height:60px}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:focus{outline:0}.content[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:50px!important;position:absolute;right:0;top:3px}.item[_ngcontent-%COMP%]{box-shadow:1px 3px 8px 5px #c2c2c2;border-radius:10px}.item[_ngcontent-%COMP%]   .img-item[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:cover;background-position:50%;background-color:#c2c2c2;border-radius:10px 10px 0 0;max-width:100%;min-width:100%;max-height:90.8vw;min-height:90.8vw}.load[_ngcontent-%COMP%]{position:fixed;top:0;left:0;min-width:100vw;min-height:100vh;background-color:hsla(0,0%,100%,.9);display:flex;justify-content:center;align-items:center}.load[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{opacity:.9}[_ngcontent-%COMP%]:focus{outline:0}button[_ngcontent-%COMP%]:disabled{background-color:#e6e6e6!important}"]}),t})()}];let _=(()=>{class t{}return t.\u0275mod=d.Pb({type:t}),t.\u0275inj=d.Ob({factory:function(e){return new(e||t)},imports:[[a.l.forChild(k)],a.l]}),t})(),x=(()=>{class t{}return t.\u0275mod=d.Pb({type:t}),t.\u0275inj=d.Ob({factory:function(e){return new(e||t)},providers:[l.a],imports:[[n.c,o.c,s.o,_]]}),t})()}}]);