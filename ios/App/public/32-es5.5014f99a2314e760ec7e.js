function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{xp4b:function(e,n,t){"use strict";t.r(n),t.d(n,"EditProductsPageModule",(function(){return w}));var i=t("ofXK"),r=t("3Pt+"),a=t("TEn/"),o=t("tyNb"),c=t("nYR2"),l=t("fXoL"),s=t("H+bZ"),p=t("b6Qw"),d=t("FQVY"),b=t("Vaw3"),g=t("rIor"),u=function(e){return{"background-image":e}};function m(e,n){if(1&e){var t=l.Xb();l.Wb(0,"div",18),l.Sb(1,"div",19),l.Wb(2,"label",20),l.ec("click",(function(){l.zc(t);var e=n.index,i=n.$implicit;return l.ic().deleteProductImage(e,i.image)})),l.Jc(3,"X"),l.Vb(),l.Sb(4,"div"),l.Vb()}if(2&e){var i=n.$implicit;l.Db(1),l.oc("ngStyle",l.sc(1,u,"url("+i.image+")"))}}function h(e,n){1&e&&(l.Wb(0,"div",21),l.Sb(1,"img",22),l.Vb())}function f(e,n){if(1&e){var t=l.Xb();l.Wb(0,"div",23),l.Wb(1,"div",24),l.Wb(2,"div",25),l.Wb(3,"h6",26),l.Jc(4,"Cortar Imagen"),l.Vb(),l.Wb(5,"img",27),l.ec("click",(function(){return l.zc(t),l.ic().handleCancelCortar()})),l.Vb(),l.Vb(),l.Wb(6,"div",4),l.Wb(7,"div",28),l.Wb(8,"div",29),l.Wb(9,"h5"),l.Jc(10,"Cortar Imagen"),l.Vb(),l.Wb(11,"image-cropper",30),l.ec("imageCropped",(function(e){return l.zc(t),l.ic().imageCropped(e)}))("imageLoaded",(function(){return l.zc(t),l.ic().imageLoaded()}))("cropperReady",(function(){return l.zc(t),l.ic().cropperReady()}))("loadImageFailed",(function(){return l.zc(t),l.ic().loadImageFailed()})),l.Vb(),l.Vb(),l.Wb(12,"div",31),l.Wb(13,"h5"),l.Jc(14,"Previsualizar"),l.Vb(),l.Sb(15,"img",32),l.Vb(),l.Vb(),l.Vb(),l.Wb(16,"div",33),l.Wb(17,"button",34),l.ec("click",(function(){return l.zc(t),l.ic().handleOkCortar()})),l.Jc(18,"Terminar"),l.Vb(),l.Vb(),l.Vb(),l.Vb()}if(2&e){var i=l.ic();l.Db(11),l.oc("imageChangedEvent",i.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",1)("resizeToWidth",0)("imageQuality",100),l.Db(4),l.oc("src",i.croppedImage,l.Bc)}}var v,C,y,x=function(){return["/tabs-provider/portfolio/products-provider"]},M=[{path:"",component:(v=function(){function e(n,t,i,r,a,o,l){var s=this;_classCallCheck(this,e),this.route=n,this.router=t,this.api=i,this.cookie=r,this.general=a,this.storage=o,this.modalController=l,this.isVisible=!1,this.contentModal=null,this.fileToUpload=null,this.nameInputFile="",this.name="",this.description="",this.price="",this.response="",this.product={},this.image="",this.isLoad=!1,this.isVisibleModal=!1,this.isVisibleCortar=!1,this.title="cloudsSorage",this.selectedFile=null,this.previewImage="",this.previewVisible=!1,this.imageChangedEvent="",this.croppedImage="",this.imagesArray=[],this.handleUpload=function(e){s.isLoad=!0;var n=Date.now(),t=s.storage.ref("products/"+n);s.storage.upload("products/"+n,e).snapshotChanges().pipe(Object(c.a)((function(){s.downloadURL=t.getDownloadURL(),s.downloadURL.subscribe((function(e){e&&(s.imagesArray.push({image:e}),s.imagesArray=s.imagesArray,s.isLoad=!1),console.log("fb",e)}))}))).subscribe((function(e){}))},this.id=this.route.snapshot.paramMap.get("id")}return _createClass(e,[{key:"ngOnInit",value:function(){this.validateSession(),0!=this.id&&this.getProductsByID()}},{key:"validateSession",value:function(){localStorage.getItem("ud")?this.user=JSON.parse(localStorage.getItem("ud")):window.location.href="/login"}},{key:"back",value:function(){window.history.back()}},{key:"isJson",value:function(e){try{JSON.parse(e)}catch(n){return!1}return!0}},{key:"getProductsByID",value:function(){var e=this;this.isLoad=!0;var n={service:"get-products-by-id",userid:this.user.user.id,productid:this.id,token:this.user.token};this.api.c("getProductsByID pre",n),this.api.api(n).subscribe((function(n){e.api.c("getProductsByID",n),e.isLoad=!1,n.status?(e.name=n.data.name,e.description=n.data.description.replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n").replace("<br />","\n"),e.price=n.data.price,e.imagesArray=n.data.images):e.api.c("getProductsByID false",n)}),(function(n){e.api.c("getProductsByID error",n)}))}},{key:"saveProduct",value:function(){var e=this;this.isLoad=!0;var n={service:"save-product",name:this.name,price:this.price,description:this.description.replace(/\n\r?/g,"<br />"),userid:this.user.user.id,type:"product",image:this.imagesArray.length>0?this.imagesArray:"",token:this.user.token,productid:this.id};this.api.api(n).subscribe((function(n){e.api.c("saveProduct res",n),e.isLoad=!1,n.status&&(e.response=n.message,0==e.id&&(e.name="",e.description="",e.price="",e.image="",e.imagesArray=[]))}),(function(n){e.api.c("saveProduct error",n)}))}},{key:"handleFileInput",value:function(e){this.fileToUpload=null,this.fileToUpload=e.item(0),this.nameInputFile=e.item(0).name,this.api.c("handleFileInput",this.nameInputFile)}},{key:"fileChangeEvent",value:function(e){this.showModalCortar(),this.imageChangedEvent=e}},{key:"imageCropped",value:function(e){this.croppedImage=e.base64}},{key:"imageLoaded",value:function(){}},{key:"cropperReady",value:function(){}},{key:"loadImageFailed",value:function(){}},{key:"dataURItoBlob",value:function(e){for(var n=window.atob(e.replace(/^data:image\/(png|jpeg|jpg);base64,/,"")),t=new ArrayBuffer(n.length),i=new Uint8Array(t),r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return new Blob([i],{type:"image/png"})}},{key:"showModalCortar",value:function(){this.isVisibleCortar=!0}},{key:"handleOkCortar",value:function(){this.isLoad=!0,this.isVisibleCortar=!1;var e=this.dataURItoBlob(this.croppedImage),n=new File([e],"name.png",{type:"image/png"});this.handleUpload(n)}},{key:"handleCancelCortar",value:function(){this.isVisibleCortar=!1}},{key:"showModal",value:function(e){this.contentModal=e,this.isVisible=!0}},{key:"deleteProductImage",value:function(e,n){var t=this;this.isLoad=!0,this.storage.storage.refFromURL(n).delete().then((function(){t.imagesArray.splice(e,1),t.saveProduct()}))}}]),e}(),v.\u0275fac=function(e){return new(e||v)(l.Rb(o.a),l.Rb(o.j),l.Rb(s.a),l.Rb(p.a),l.Rb(d.a),l.Rb(b.a),l.Rb(a.q))},v.\u0275cmp=l.Lb({type:v,selectors:[["app-edit-products"]],decls:31,vars:10,consts:[[1,"pt-3","pr-3","pl-3"],[1,"btn1","pt-2","pb-2",3,"routerLink"],[1,"linea"],[1,"p-3","col-xl-5","col-12"],[1,"form-group","mt-2"],[1,"inputImage"],["accept","image/*","type","file",1,"form-control",3,"ngModel","change","ngModelChange"],[1,"row","justify-content-center","mt-5"],["class","row flex-column m-0 align-items-center justify-content-center",4,"ngFor","ngForOf"],[1,"p-3","col-xl-5","col-12","pb-5","mb-5"],["type","text","placeholder","Ingrese el nombre",1,"form-control",3,"ngModel","ngModelChange"],["name","","id","","cols","30","rows","4","placeholder","Ingrese la descripci\xf3n",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","Ingrese el precio",1,"form-control",3,"ngModel","ngModelChange"],[1,"row","justify-content-end","m-0","col-12"],[1,"btn1","font-700","pt-2","pb-2",3,"click"],[1,"text-color4","font-700","text-center"],["class","load",4,"ngIf"],["class","modal",4,"ngIf"],[1,"row","flex-column","m-0","align-items-center","justify-content-center"],[1,"img-item","m-2",3,"ngStyle"],["title","Eliminar",1,"pi","pi-times","text-danger","font-900","cursor","f-16",3,"click"],[1,"load"],["src","/assets/img/partials/load.svg"],[1,"modal"],[1,"content-modal","modal2","p-5"],[1,"header-modal","row","m-0","justify-content-between","align-items-center"],[1,"title-modal","font-700","text-color2"],["width","20","src","assets/img/partials/close.svg",3,"click"],[1,"row",2,"margin-top","5%"],[1,"text-center","col-md-8"],["format","png",3,"imageChangedEvent","maintainAspectRatio","aspectRatio","resizeToWidth","imageQuality","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"text-center","col-md-4"],[1,"source-image",3,"src"],[1,"mt-3","row","justify-content-end"],[1,"btn1","pl-3","pr-3","pt-1","pb-1","mr-3",3,"click"]],template:function(e,n){1&e&&(l.Wb(0,"ion-content"),l.Wb(1,"header",0),l.Wb(2,"button",1),l.Jc(3,"Regresar"),l.Vb(),l.Vb(),l.Sb(4,"hr",2),l.Wb(5,"div",3),l.Wb(6,"h4"),l.Jc(7,"Im\xe1genes"),l.Vb(),l.Wb(8,"div",4),l.Wb(9,"div",5),l.Wb(10,"input",6),l.ec("change",(function(e){return n.fileChangeEvent(e)}))("ngModelChange",(function(e){return n.image=e})),l.Vb(),l.Wb(11,"div"),l.Jc(12,"Seleccione una imagen"),l.Vb(),l.Vb(),l.Vb(),l.Wb(13,"div",7),l.Hc(14,m,5,3,"div",8),l.Vb(),l.Sb(15,"hr"),l.Vb(),l.Wb(16,"div",9),l.Wb(17,"div",4),l.Wb(18,"input",10),l.ec("ngModelChange",(function(e){return n.name=e})),l.Vb(),l.Vb(),l.Wb(19,"div",4),l.Wb(20,"textarea",11),l.ec("ngModelChange",(function(e){return n.description=e})),l.Vb(),l.Vb(),l.Wb(21,"div",4),l.Wb(22,"input",12),l.ec("ngModelChange",(function(e){return n.price=e})),l.Vb(),l.Vb(),l.Wb(23,"div",13),l.Wb(24,"button",14),l.ec("click",(function(){return n.saveProduct()})),l.Jc(25,"Guardar"),l.Vb(),l.Vb(),l.Wb(26,"div",4),l.Wb(27,"p",15),l.Jc(28),l.Vb(),l.Vb(),l.Vb(),l.Hc(29,h,2,0,"div",16),l.Hc(30,f,19,6,"div",17),l.Vb()),2&e&&(l.Db(2),l.oc("routerLink",l.rc(9,x)),l.Db(8),l.oc("ngModel",n.image),l.Db(4),l.oc("ngForOf",n.imagesArray),l.Db(4),l.oc("ngModel",n.name),l.Db(2),l.oc("ngModel",n.description),l.Db(2),l.oc("ngModel",n.price),l.Db(6),l.Kc(n.response),l.Db(1),l.oc("ngIf",n.isLoad),l.Db(1),l.oc("ngIf",n.isVisibleCortar))},directives:[a.d,a.s,o.k,r.b,r.f,r.g,i.k,i.l,i.m,g.a],styles:[".carrusel[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{background-size:cover;background-repeat:no-repeat;background-position:50%;min-width:100%;min-height:200px;border-radius:16px;padding:10px}.menu[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{min-width:20px;min-height:2px;background-color:#fff}.search[_ngcontent-%COMP%]{flex:1;position:relative}.search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-moz-placeholder{color:grey;font-size:12pt}.search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-ms-input-placeholder{color:grey;font-size:12pt}.search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{color:grey;font-size:12pt}.search[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:27%;left:20px;max-width:26px}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:12pt;width:100%;border:2.5px solid #ffe266;background-color:transparent;color:#333;border-radius:50px;padding:5px 5px 5px 58px;min-height:60px}.search[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:focus{outline:0}.main-photo[_ngcontent-%COMP%]{border-radius:10px;background-color:#e6e6e6;min-height:260px}.add[_ngcontent-%COMP%]{max-width:40px}.modal[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.4);display:flex;justify-content:center;align-items:flex-start;position:fixed;min-width:100vw;min-height:100vh;top:0;left:0;z-index:100}.modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{border:0;background-color:#fff;margin-top:80px;border-radius:10px;padding:20px;min-height:100px}.load[_ngcontent-%COMP%]{position:fixed;top:0;left:0;min-width:100vw;min-height:100vh;background-color:hsla(0,0%,100%,.9);display:flex;justify-content:center;align-items:center}.load[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{opacity:.9}.image-cropper[_ngcontent-%COMP%]{max-height:500px!important}.source-image[_ngcontent-%COMP%]{max-width:300px!important}.modal[_ngcontent-%COMP%]{overflow:auto}.modal2[_ngcontent-%COMP%]{max-width:90%!important;min-width:90%!important;position:absolute;top:150px;margin-bottom:150px;background-color:#fff}@media (max-width:1300px){.modal2[_ngcontent-%COMP%]{max-width:90%!important}}@media (max-width:960px){.modal2[_ngcontent-%COMP%]{max-width:98%!important}}.img-item[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:cover;background-color:#e6e6e6;background-position:50%;min-width:80px;max-width:80px;max-height:80px;min-height:80px}.inputImage[_ngcontent-%COMP%]{position:relative;cursor:pointer}.inputImage[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;z-index:2}.inputImage[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .inputImage[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;top:0;left:0;border-radius:8px}.inputImage[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;opacity:1;min-width:100%;min-height:40px;background-color:#ffe266;z-index:1}"]}),v)}],P=((y=function e(){_classCallCheck(this,e)}).\u0275mod=l.Pb({type:y}),y.\u0275inj=l.Ob({factory:function(e){return new(e||y)},imports:[[o.l.forChild(M)],o.l]}),y),w=((C=function e(){_classCallCheck(this,e)}).\u0275mod=l.Pb({type:C}),C.\u0275inj=l.Ob({factory:function(e){return new(e||C)},imports:[[i.c,r.c,a.o,P,g.b]]}),C)}}]);